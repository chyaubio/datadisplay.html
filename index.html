<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@artej/a-frame@0.19.0/dist/aframe-master.min.js"></script>
    <script src="https://cdn.rawgit.com/artoolkit/jsartoolkit5/master/dist/artoolkit.min.js"></script>
    <script src="https://cdn.rawgit.com/artoolkit/jsartoolkit5/master/dist/artoolkit.api.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@artoolkit/jsartoolkit5-ar.js@0.19.0/dist/artoolkit.ar.min.js"></script>
    <style>
      #air-quality-data {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 400px;
        height: 200px;
        background-color: rgba(255, 255, 255, 0.8);
        padding: 10px;
        text-align: center;
        border-radius: 10px;
        opacity: 0;
      }
      #arjs-logo {
        position: absolute;
        top: 50%;
        left: 50%;
        center: 50%;
        transform: translate(-50%, -50%);
        margin-top:-600px;
        width: 500px;
        height: 500px;
        opacity: 0;
      }
    </style>
  </head>
  <body style="margin: 0; overflow: hidden;">
    <a-scene id="arjs-scene" renderer="logarithmicDepthBuffer: true">
      <a-marker id="marker" type="pattern" url="pattern-file.patt">
        <a-entity id="logo" scale="0.5 0.5 0.5" obj-model="obj: url(companylogo.obj); mtl: url(companylogo.mtl);" ></a-entity>
      </a-marker>
      <a-camera-static />
    </a-scene>
    <div id="webcam-feed"></div>
    <img id="arjs-logo" src="https://raw.githubusercontent.com/chyaubio/datadisplay.html/main/companylogo.png">
    <div id="air-quality-data"></div>
    <script>
      // Get the webcam feed
      navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" }, audio: false })
        .then(function (stream) {
          var video = document.createElement("video");
          video.srcObject = stream;
          video.play();
          video.style.width = "100%";
          video.style.height = "100%";
          video.style.objectFit = "cover";

       // Fade in the Tile for Air Quality
          $("#air-quality-data").animate({
            opacity: 0.4
          }, 4000);

// Get the device's GPS location
navigator.geolocation.getCurrentPosition(function (position) {
  var lat = position.coords.latitude;
  var lng = position.coords.longitude;

  // Get the air quality data from AQICN
  $.get(`https://api.waqi.info/feed/geo:${lat};${lng}/?token=b4925c40110ed2049ee5f6deb33a490b38a9f1e3`, function (aqData) {
    var aqIndex = aqData.data.aqi;
    var aqLevel = "";
    var aqColor = "";
    if (aqIndex <= 50) {
      aqLevel = "Good";
      aqColor = "green";
    } else if (aqIndex <= 100) {
      aqLevel = "Moderate";
      aqColor = "yellow";
    } else if (aqIndex <= 150) {
      aqLevel = "Unhealthy for Sensitive Groups";
      aqColor = "orange";
    } else if (aqIndex <= 200) {
      aqLevel = "Unhealthy";
      aqColor = "red";
    } else if (aqIndex <= 300) {
      aqLevel = "Very Unhealthy";
      aqColor = "darkred";
    } else {
      aqLevel = "Hazardous";
      aqColor = "purple";
    }
    document.getElementById("air-quality-data").innerHTML = `<p style="color: ${aqColor};">Air Quality Index: ${aqIndex} (${aqLevel})</p>`;
    
    // Get the weather data from AQICN
    $.get(`https://api.waqi.info/feed/geo:${lat};${lng}/?token=b4925c40110ed2049ee5f6deb33a490b38a9f1e3`, function (weatherData) {
      // Use the weatherData object to display the weather information
      var temperature = weatherData.main.temp;
      var humidity = weatherData.main.humidity;
      var weather = weatherData.weather[0].description;
      document.getElementById("air-quality-data").innerHTML += `<p>Temperature: ${temperature} &#8451;</p><p>Humidity: ${humidity}%</p><p>Weather: ${weather}</p>`;
    });
  });
});
        })
        .catch(function (err) {
          console.error("Failed to get webcam feed:", err);
        });
    </script>
  </body>
</html>
